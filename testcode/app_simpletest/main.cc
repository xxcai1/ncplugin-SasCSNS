#include "NCSansIsotropic.hh"
#include <iostream>
#include "NCrystal/internal/NCMath.hh"//for NC::linspace
#include <vector>
int main()
{
  //Very simple test which instantiates our model and calculates a few cross
  //sections and samples a few scattering events:
  std::vector<double> Q{0.0001, 0.000100856, 0.00010172, 0.000102591, 0.000103469, 0.000104355, 0.000105249, 0.00010615, 0.000107059, 0.000107975, 0.0001089, 0.000109832, 0.000110773, 0.000111721, 0.000112678, 0.000113642, 0.000114615, 0.000115597, 0.000116586, 0.000117585, 0.000118591, 0.000119607, 0.000120631, 0.000121664, 0.000122706, 0.000123756, 0.000124816, 0.000125884, 0.000126962, 0.000128049, 0.000129146, 0.000130252, 0.000131367, 0.000132492, 0.000133626, 0.00013477, 0.000135924, 0.000137088, 0.000138262, 0.000139445, 0.000140639, 0.000141844, 0.000143058, 0.000144283, 0.000145518, 0.000146764, 0.000148021, 0.000149288, 0.000150566, 0.000151856, 0.000153156, 0.000154467, 0.00015579, 0.000157124, 0.000158469, 0.000159826, 0.000161194, 0.000162574, 0.000163966, 0.00016537, 0.000166786, 0.000168214, 0.000169655, 0.000171107, 0.000172572, 0.00017405, 0.00017554, 0.000177043, 0.000178559, 0.000180088, 0.00018163, 0.000183185, 0.000184753, 0.000186335, 0.000187931, 0.00018954, 0.000191163, 0.000192799, 0.00019445, 0.000196115, 0.000197794, 0.000199488, 0.000201196, 0.000202919, 0.000204656, 0.000206408, 0.000208176, 0.000209958, 0.000211756, 0.000213569, 0.000215397, 0.000217242, 0.000219102, 0.000220978, 0.00022287, 0.000224778, 0.000226703, 0.000228644, 0.000230601, 0.000232576, 0.000234567, 0.000236576, 0.000238601, 0.000240644, 0.000242705, 0.000244783, 0.000246879, 0.000248992, 0.000251124, 0.000253274, 0.000255443, 0.00025763, 0.000259836, 0.000262061, 0.000264305, 0.000266568, 0.00026885, 0.000271152, 0.000273474, 0.000275815, 0.000278177, 0.000280558, 0.000282961, 0.000285383, 0.000287827, 0.000290291, 0.000292777, 0.000295284, 0.000297812, 0.000300362, 0.000302934, 0.000305527, 0.000308143, 0.000310782, 0.000313443, 0.000316126, 0.000318833, 0.000321563, 0.000324316, 0.000327093, 0.000329894, 0.000332718, 0.000335567, 0.00033844, 0.000341338, 0.000344261, 0.000347208, 0.000350181, 0.00035318, 0.000356204, 0.000359253, 0.000362329, 0.000365432, 0.000368561, 0.000371716, 0.000374899, 0.000378109, 0.000381346, 0.000384612, 0.000387905, 0.000391226, 0.000394576, 0.000397954, 0.000401361, 0.000404798, 0.000408264, 0.00041176, 0.000415285, 0.000418841, 0.000422427, 0.000426044, 0.000429692, 0.000433371, 0.000437081, 0.000440824, 0.000444598, 0.000448405, 0.000452244, 0.000456116, 0.000460022, 0.000463961, 0.000467933, 0.00047194, 0.00047598, 0.000480056, 0.000484166, 0.000488312, 0.000492493, 0.000496709, 0.000500962, 0.000505252, 0.000509578, 0.000513941, 0.000518341, 0.000522779, 0.000527256, 0.00053177, 0.000536323, 0.000540915, 0.000545547, 0.000550218, 0.000554929, 0.00055968, 0.000564472, 0.000569305, 0.00057418, 0.000579096, 0.000584054, 0.000589055, 0.000594099, 0.000599185, 0.000604316, 0.00060949, 0.000614709, 0.000619972, 0.00062528, 0.000630634, 0.000636033, 0.000641479, 0.000646972, 0.000652511, 0.000658098, 0.000663733, 0.000669416, 0.000675148, 0.000680928, 0.000686758, 0.000692639, 0.000698569, 0.00070455, 0.000710583, 0.000716667, 0.000722803, 0.000728992, 0.000735234, 0.000741529, 0.000747878, 0.000754281, 0.00076074, 0.000767253, 0.000773823, 0.000780448, 0.000787131, 0.00079387, 0.000800667, 0.000807523, 0.000814437, 0.00082141, 0.000828443, 0.000835537, 0.000842691, 0.000849906, 0.000857183, 0.000864522, 0.000871924, 0.00087939, 0.00088692, 0.000894513, 0.000902172, 0.000909897, 0.000917688, 0.000925545, 0.00093347, 0.000941462, 0.000949523, 0.000957653, 0.000965853, 0.000974123, 0.000982463, 0.000990875, 0.000999359, 0.00100792, 0.00101655, 0.00102525, 0.00103403, 0.00104288, 0.00105181, 0.00106082, 0.0010699, 0.00107906, 0.0010883, 0.00109762, 0.00110702, 0.00111649, 0.00112605, 0.00113569, 0.00114542, 0.00115523, 0.00116512, 0.00117509, 0.00118515, 0.0011953, 0.00120554, 0.00121586, 0.00122627, 0.00123677, 0.00124736, 0.00125804, 0.00126881, 0.00127967, 0.00129063, 0.00130168, 0.00131283, 0.00132407, 0.0013354, 0.00134684, 0.00135837, 0.00137, 0.00138173, 0.00139356, 0.00140549, 0.00141753, 0.00142966, 0.0014419, 0.00145425, 0.0014667, 0.00147926, 0.00149193, 0.0015047, 0.00151758, 0.00153058, 0.00154368, 0.0015569, 0.00157023, 0.00158367, 0.00159723, 0.00161091, 0.0016247, 0.00163861, 0.00165264, 0.00166679, 0.00168107, 0.00169546, 0.00170998, 0.00172462, 0.00173938, 0.00175428, 0.0017693, 0.00178445, 0.00179972, 0.00181513, 0.00183068, 0.00184635, 0.00186216, 0.0018781, 0.00189418, 0.0019104, 0.00192676, 0.00194326, 0.00195989, 0.00197668, 0.0019936, 0.00201067, 0.00202789, 0.00204525, 0.00206276, 0.00208042, 0.00209824, 0.0021162, 0.00213432, 0.00215259, 0.00217103, 0.00218961, 0.00220836, 0.00222727, 0.00224634, 0.00226557, 0.00228497, 0.00230454, 0.00232427, 0.00234417, 0.00236424, 0.00238448, 0.0024049, 0.00242549, 0.00244626, 0.0024672, 0.00248833, 0.00250963, 0.00253112, 0.00255279, 0.00257465, 0.0025967, 0.00261893, 0.00264135, 0.00266397, 0.00268678, 0.00270978, 0.00273298, 0.00275638, 0.00277998, 0.00280379, 0.00282779, 0.00285201, 0.00287642, 0.00290105, 0.00292589, 0.00295094, 0.00297621, 0.00300169, 0.00302739, 0.00305332, 0.00307946, 0.00310583, 0.00313242, 0.00315924, 0.00318629, 0.00321357, 0.00324109, 0.00326884, 0.00329682, 0.00332505, 0.00335352, 0.00338224, 0.00341119, 0.0034404, 0.00346986, 0.00349957, 0.00352953, 0.00355975, 0.00359023, 0.00362097, 0.00365198, 0.00368324, 0.00371478, 0.00374659, 0.00377867, 0.00381102, 0.00384365, 0.00387656, 0.00390975, 0.00394323, 0.00397699, 0.00401104, 0.00404539, 0.00408002, 0.00411496, 0.00415019, 0.00418572, 0.00422156, 0.00425771, 0.00429416, 0.00433093, 0.00436801, 0.00440541, 0.00444313, 0.00448118, 0.00451954, 0.00455824, 0.00459727, 0.00463663, 0.00467633, 0.00471637, 0.00475675, 0.00479748, 0.00483856, 0.00487999, 0.00492177, 0.00496391, 0.00500641, 0.00504928, 0.00509251, 0.00513612, 0.00518009, 0.00522444, 0.00526918, 0.00531429, 0.00535979, 0.00540569, 0.00545197, 0.00549865, 0.00554573, 0.00559321, 0.0056411, 0.0056894, 0.00573812, 0.00578725, 0.0058368, 0.00588678, 0.00593718, 0.00598802, 0.00603929, 0.00609099, 0.00614315, 0.00619575, 0.00624879, 0.0063023, 0.00635626, 0.00641068, 0.00646557, 0.00652093, 0.00657676, 0.00663308, 0.00668987, 0.00674715, 0.00680492, 0.00686318, 0.00692195, 0.00698121, 0.00704099, 0.00710128, 0.00716208, 0.0072234, 0.00728525, 0.00734763, 0.00741054, 0.00747399, 0.00753798, 0.00760252, 0.00766762, 0.00773327, 0.00779948, 0.00786626, 0.00793361, 0.00800154, 0.00807005, 0.00813915, 0.00820884, 0.00827913, 0.00835001, 0.00842151, 0.00849361, 0.00856634, 0.00863968, 0.00871366, 0.00878827, 0.00886351, 0.0089394, 0.00901594, 0.00909314, 0.009171, 0.00924952, 0.00932872, 0.00940859, 0.00948915, 0.0095704, 0.00965234, 0.00973498, 0.00981834, 0.0099024, 0.00998719, 0.0100727, 0.0101589, 0.0102459, 0.0103337, 0.0104221, 0.0105114, 0.0106014, 0.0106921, 0.0107837, 0.010876, 0.0109691, 0.0110631, 0.0111578, 0.0112533, 0.0113497, 0.0114469, 0.0115449, 0.0116437, 0.0117434, 0.011844, 0.0119454, 0.0120476, 0.0121508, 0.0122548, 0.0123598, 0.0124656, 0.0125723, 0.01268, 0.0127885, 0.012898, 0.0130085, 0.0131198, 0.0132322, 0.0133455, 0.0134597, 0.013575, 0.0136912, 0.0138084, 0.0139267, 0.0140459, 0.0141662, 0.0142875, 0.0144098, 0.0145332, 0.0146576, 0.0147831, 0.0149097, 0.0150374, 0.0151661, 0.015296, 0.0154269, 0.015559, 0.0156922, 0.0158266, 0.0159621, 0.0160988, 0.0162366, 0.0163756, 0.0165159, 0.0166573, 0.0167999, 0.0169437, 0.0170888, 0.0172351, 0.0173827, 0.0175315, 0.0176816, 0.017833, 0.0179857, 0.0181397, 0.018295, 0.0184517, 0.0186097, 0.018769, 0.0189297, 0.0190918, 0.0192552, 0.0194201, 0.0195864, 0.0197541, 0.0199232, 0.0200938, 0.0202659, 0.0204394, 0.0206144, 0.0207909, 0.0209689, 0.0211484, 0.0213295, 0.0215121, 0.0216963, 0.0218821, 0.0220695, 0.0222584, 0.022449, 0.0226412, 0.0228351, 0.0230306, 0.0232278, 0.0234267, 0.0236273, 0.0238296, 0.0240336, 0.0242394, 0.0244469, 0.0246562, 0.0248673, 0.0250803, 0.025295, 0.0255116, 0.02573, 0.0259503, 0.0261725, 0.0263966, 0.0266226, 0.0268506, 0.0270805, 0.0273123, 0.0275462, 0.027782, 0.0280199, 0.0282598, 0.0285018, 0.0287458, 0.0289919, 0.0292402, 0.0294905, 0.029743, 0.0299977, 0.0302545, 0.0305136, 0.0307749, 0.0310384, 0.0313041, 0.0315721, 0.0318425, 0.0321151, 0.0323901, 0.0326674, 0.0329471, 0.0332292, 0.0335137, 0.0338007, 0.0340901, 0.034382, 0.0346764, 0.0349733, 0.0352727, 0.0355747, 0.0358793, 0.0361865, 0.0364964, 0.0368088, 0.037124, 0.0374419, 0.0377625, 0.0380858, 0.0384119, 0.0387408, 0.0390725, 0.039407, 0.0397444, 0.0400847, 0.0404279, 0.0407741, 0.0411232, 0.0414753, 0.0418304, 0.0421886, 0.0425498, 0.0429141, 0.0432816, 0.0436521, 0.0440259, 0.0444029, 0.044783, 0.0451665, 0.0455532, 0.0459432, 0.0463366, 0.0467334, 0.0471335, 0.0475371, 0.0479441, 0.0483546, 0.0487686, 0.0491862, 0.0496073, 0.0500321, 0.0504604, 0.0508925, 0.0513282, 0.0517677, 0.052211, 0.052658, 0.0531089, 0.0535636, 0.0540222, 0.0544848, 0.0549513, 0.0554218, 0.0558963, 0.0563749, 0.0568576, 0.0573444, 0.0578354, 0.0583306, 0.05883, 0.0593338, 0.0598418, 0.0603542, 0.0608709, 0.0613921, 0.0619178, 0.0624479, 0.0629826, 0.0635219, 0.0640657, 0.0646143, 0.0651675, 0.0657255, 0.0662883, 0.0668558, 0.0674283, 0.0680056, 0.0685879, 0.0691751, 0.0697674, 0.0703648, 0.0709672, 0.0715749, 0.0721877, 0.0728058, 0.0734292, 0.0740579, 0.074692, 0.0753315, 0.0759765, 0.076627, 0.0772831, 0.0779448, 0.0786122, 0.0792853, 0.0799642, 0.0806488, 0.0813394, 0.0820358, 0.0827382, 0.0834466, 0.0841611, 0.0848817, 0.0856085, 0.0863415, 0.0870807, 0.0878263, 0.0885783, 0.0893367, 0.0901017, 0.0908731, 0.0916512, 0.0924359, 0.0932274, 0.0940256, 0.0948307, 0.0956426, 0.0964615, 0.0972875, 0.0981204, 0.0989606, 0.0998079, 0.100662, 0.101524, 0.102394, 0.10327, 0.104155, 0.105046, 0.105946, 0.106853, 0.107768, 0.108691, 0.109621, 0.11056, 0.111506, 0.112461, 0.113424, 0.114395, 0.115375, 0.116362, 0.117359, 0.118364, 0.119377, 0.120399, 0.12143, 0.12247, 0.123518, 0.124576, 0.125643, 0.126718, 0.127803, 0.128898, 0.130001, 0.131114, 0.132237, 0.133369, 0.134511, 0.135663, 0.136824, 0.137996, 0.139178, 0.140369, 0.141571, 0.142783, 0.144006, 0.145239, 0.146482, 0.147737, 0.149001, 0.150277, 0.151564, 0.152862, 0.15417, 0.15549, 0.156822, 0.158165, 0.159519, 0.160885, 0.162262, 0.163651, 0.165053, 0.166466, 0.167891, 0.169329, 0.170779, 0.172241, 0.173716, 0.175203, 0.176703, 0.178216, 0.179742, 0.181281, 0.182833, 0.184398, 0.185977, 0.18757, 0.189176, 0.190795, 0.192429, 0.194077, 0.195738, 0.197414, 0.199105, 0.200809, 0.202529, 0.204263, 0.206012, 0.207776, 0.209555, 0.211349, 0.213159, 0.214984, 0.216824, 0.218681, 0.220553, 0.222442, 0.224346, 0.226267, 0.228204, 0.230158, 0.232129, 0.234117, 0.236121, 0.238143, 0.240182, 0.242238, 0.244312, 0.246404, 0.248514, 0.250642, 0.252788, 0.254952, 0.257135, 0.259337, 0.261557, 0.263797, 0.266055, 0.268334, 0.270631, 0.272948, 0.275285, 0.277642, 0.280019, 0.282417, 0.284835, 0.287274, 0.289734, 0.292214, 0.294716, 0.29724, 0.299785, 0.302352, 0.30494, 0.307551, 0.310185, 0.312841, 0.315519, 0.318221, 0.320945, 0.323693, 0.326465, 0.32926, 0.332079, 0.334923, 0.33779, 0.340682, 0.343599, 0.346541, 0.349509, 0.352501, 0.355519, 0.358563, 0.361633, 0.36473, 0.367853, 0.371002, 0.374179, 0.377383, 0.380614, 0.383873, 0.387159, 0.390474, 0.393818, 0.39719, 0.40059, 0.40402, 0.40748, 0.410968, 0.414487, 0.418036, 0.421615, 0.425225, 0.428866, 0.432538, 0.436242, 0.439977, 0.443744, 0.447544, 0.451375, 0.45524, 0.459138, 0.463069, 0.467034, 0.471033, 0.475066, 0.479134, 0.483236, 0.487374, 0.491547, 0.495755, 0.5};
  std::vector<double> I{120.34, 120.34, 120.34, 120.34, 120.34, 120.34, 120.34, 120.34, 120.34, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.339, 120.338, 120.338, 120.338, 120.338, 120.338, 120.338, 120.338, 120.338, 120.338, 120.338, 120.338, 120.338, 120.338, 120.338, 120.337, 120.337, 120.337, 120.337, 120.337, 120.337, 120.337, 120.337, 120.337, 120.337, 120.337, 120.336, 120.336, 120.336, 120.336, 120.336, 120.336, 120.336, 120.336, 120.336, 120.335, 120.335, 120.335, 120.335, 120.335, 120.335, 120.335, 120.335, 120.334, 120.334, 120.334, 120.334, 120.334, 120.334, 120.334, 120.333, 120.333, 120.333, 120.333, 120.333, 120.333, 120.333, 120.332, 120.332, 120.332, 120.332, 120.332, 120.331, 120.331, 120.331, 120.331, 120.331, 120.331, 120.33, 120.33, 120.33, 120.33, 120.329, 120.329, 120.329, 120.329, 120.329, 120.328, 120.328, 120.328, 120.328, 120.327, 120.327, 120.327, 120.327, 120.326, 120.326, 120.326, 120.325, 120.325, 120.325, 120.325, 120.324, 120.324, 120.324, 120.323, 120.323, 120.323, 120.322, 120.322, 120.322, 120.321, 120.321, 120.321, 120.32, 120.32, 120.319, 120.319, 120.319, 120.318, 120.318, 120.317, 120.317, 120.317, 120.316, 120.316, 120.315, 120.315, 120.314, 120.314, 120.313, 120.313, 120.312, 120.312, 120.311, 120.311, 120.31, 120.31, 120.309, 120.308, 120.308, 120.307, 120.307, 120.306, 120.305, 120.305, 120.304, 120.304, 120.303, 120.302, 120.301, 120.301, 120.3, 120.299, 120.299, 120.298, 120.297, 120.296, 120.296, 120.295, 120.294, 120.293, 120.292, 120.291, 120.29, 120.29, 120.289, 120.288, 120.287, 120.286, 120.285, 120.284, 120.283, 120.282, 120.281, 120.28, 120.279, 120.278, 120.277, 120.275, 120.274, 120.273, 120.272, 120.271, 120.269, 120.268, 120.267, 120.266, 120.264, 120.263, 120.262, 120.26, 120.259, 120.257, 120.256, 120.254, 120.253, 120.251, 120.25, 120.248, 120.247, 120.245, 120.243, 120.242, 120.24, 120.238, 120.236, 120.234, 120.233, 120.231, 120.229, 120.227, 120.225, 120.223, 120.221, 120.219, 120.217, 120.214, 120.212, 120.21, 120.208, 120.205, 120.203, 120.201, 120.198, 120.196, 120.193, 120.191, 120.188, 120.185, 120.183, 120.18, 120.177, 120.174, 120.171, 120.169, 120.166, 120.162, 120.159, 120.156, 120.153, 120.15, 120.147, 120.143, 120.14, 120.136, 120.133, 120.129, 120.125, 120.122, 120.118, 120.114, 120.11, 120.106, 120.102, 120.098, 120.094, 120.09, 120.085, 120.081, 120.076, 120.072, 120.067, 120.062, 120.057, 120.053, 120.048, 120.043, 120.037, 120.032, 120.027, 120.021, 120.016, 120.01, 120.005, 119.999, 119.993, 119.987, 119.981, 119.975, 119.968, 119.962, 119.955, 119.949, 119.942, 119.935, 119.928, 119.921, 119.914, 119.906, 119.899, 119.891, 119.884, 119.876, 119.868, 119.859, 119.851, 119.843, 119.834, 119.825, 119.817, 119.808, 119.798, 119.789, 119.78, 119.77, 119.76, 119.75, 119.74, 119.73, 119.719, 119.708, 119.698, 119.686, 119.675, 119.664, 119.652, 119.64, 119.628, 119.616, 119.604, 119.591, 119.578, 119.565, 119.552, 119.538, 119.524, 119.51, 119.496, 119.481, 119.467, 119.452, 119.436, 119.421, 119.405, 119.389, 119.373, 119.356, 119.339, 119.322, 119.304, 119.287, 119.269, 119.25, 119.231, 119.212, 119.193, 119.173, 119.153, 119.133, 119.112, 119.091, 119.07, 119.048, 119.026, 119.003, 118.98, 118.957, 118.933, 118.909, 118.885, 118.86, 118.835, 118.809, 118.783, 118.756, 118.729, 118.701, 118.673, 118.645, 118.616, 118.586, 118.556, 118.525, 118.494, 118.463, 118.431, 118.398, 118.365, 118.331, 118.297, 118.262, 118.226, 118.19, 118.154, 118.116, 118.078, 118.04, 118, 117.96, 117.92, 117.879, 117.837, 117.794, 117.75, 117.706, 117.661, 117.616, 117.569, 117.522, 117.474, 117.425, 117.376, 117.325, 117.274, 117.222, 117.169, 117.115, 117.06, 117.004, 116.947, 116.89, 116.831, 116.772, 116.711, 116.649, 116.587, 116.523, 116.458, 116.392, 116.325, 116.257, 116.188, 116.118, 116.046, 115.974, 115.9, 115.825, 115.748, 115.67, 115.591, 115.511, 115.43, 115.347, 115.262, 115.177, 115.089, 115.001, 114.911, 114.819, 114.726, 114.632, 114.535, 114.438, 114.338, 114.237, 114.135, 114.03, 113.924, 113.817, 113.707, 113.596, 113.483, 113.368, 113.251, 113.132, 113.011, 112.889, 112.764, 112.638, 112.509, 112.378, 112.245, 112.11, 111.973, 111.833, 111.692, 111.548, 111.401, 111.253, 111.102, 110.948, 110.792, 110.634, 110.473, 110.31, 110.144, 109.975, 109.803, 109.629, 109.452, 109.273, 109.09, 108.905, 108.717, 108.526, 108.331, 108.134, 107.934, 107.73, 107.524, 107.314, 107.101, 106.885, 106.665, 106.442, 106.215, 105.985, 105.752, 105.515, 105.274, 105.03, 104.782, 104.53, 104.275, 104.015, 103.752, 103.485, 103.213, 102.938, 102.659, 102.375, 102.088, 101.796, 101.499, 101.199, 100.894, 100.584, 100.271, 99.9521, 99.629, 99.3014, 98.969, 98.6319, 98.29, 97.9433, 97.5916, 97.2351, 96.8735, 96.5069, 96.1352, 95.7583, 95.3763, 94.989, 94.5965, 94.1986, 93.7953, 93.3866, 92.9725, 92.5528, 92.1275, 91.6967, 91.2602, 90.818, 90.37, 89.9163, 89.4568, 88.9915, 88.5202, 88.043, 87.5599, 87.0707, 86.5755, 86.0743, 85.567, 85.0535, 84.534, 84.0082, 83.4763, 82.9381, 82.3937, 81.8431, 81.2861, 80.723, 80.1535, 79.5777, 78.9956, 78.4073, 77.8126, 77.2116, 76.6043, 75.9907, 75.3708, 74.7447, 74.1123, 73.4737, 72.8289, 72.1779, 71.5208, 70.8575, 70.1882, 69.5129, 68.8315, 68.1443, 67.4512, 66.7522, 66.0475, 65.3372, 64.6212, 63.8997, 63.1727, 62.4405, 61.7029, 60.9602, 60.2125, 59.4598, 58.7023, 57.94, 57.1733, 56.402, 55.6265, 54.8468, 54.0632, 53.2757, 52.4845, 51.6898, 50.8918, 50.0906, 49.2866, 48.4797, 47.6703, 46.8586, 46.0448, 45.2291, 44.4117, 43.5929, 42.773, 41.9521, 41.1305, 40.3086, 39.4865, 38.6646, 37.8432, 37.0224, 36.2027, 35.3844, 34.5676, 33.7529, 32.9404, 32.1305, 31.3235, 30.5198, 29.7198, 28.9237, 28.1318, 27.3447, 26.5625, 25.7858, 25.0147, 24.2498, 23.4913, 22.7396, 21.9952, 21.2583, 20.5294, 19.8087, 19.0967, 18.3938, 17.7002, 17.0164, 16.3427, 15.6795, 15.027, 14.3858, 13.7559, 13.1379, 12.5321, 11.9386, 11.3579, 10.7902, 10.2358, 9.695, 9.168, 8.65506, 8.15642, 7.67228, 7.20283, 6.74826, 6.30872, 5.88436, 5.4753, 5.08165, 4.70348, 4.34086, 3.99383, 3.66241, 3.34659, 3.04634, 2.76161, 2.49232, 2.23837, 1.99963, 1.77595, 1.56715, 1.37303, 1.19334, 1.02785, 0.876274, 0.738298, 0.613595, 0.501812, 0.402569, 0.315465, 0.240077, 0.175959, 0.122646, 0.0796534, 0.0464779, 0.0226002, 0.00748557, 0.000585345, 0.00133898, 0.00917557, 0.0235158, 0.0437738, 0.0693593, 0.0996798, 0.134143, 0.172157, 0.213137, 0.256504, 0.301688, 0.34813, 0.395287, 0.44263, 0.489651, 0.535862, 0.5808, 0.624027, 0.665132, 0.703736, 0.739489, 0.772077, 0.801221, 0.826677, 0.848241, 0.865746, 0.879064, 0.88811, 0.892835, 0.893234, 0.889339, 0.881222, 0.868995, 0.852804, 0.832831, 0.809294, 0.782439, 0.752542, 0.719905, 0.684855, 0.647734, 0.608904, 0.568739, 0.52762, 0.485934, 0.444068, 0.402404, 0.361317, 0.321171, 0.282312, 0.245066, 0.209737, 0.176598, 0.145895, 0.117837, 0.0926001, 0.0703193, 0.0510909, 0.0349699, 0.0219699, 0.0120623, 0.00517792, 0.00120726, 2.79771E-06, 0.00138114, 0.00512599, 0.0109916, 0.0187069, 0.0279797, 0.0385016, 0.0499533, 0.06201, 0.0743469, 0.0866447, 0.0985956, 0.109909, 0.120315, 0.129572, 0.13747, 0.143832, 0.148523, 0.151445, 0.152545, 0.151814, 0.149282, 0.145026, 0.139159, 0.131834, 0.123235, 0.113574, 0.103087, 0.0920271, 0.0806561, 0.06924, 0.058041, 0.0473104, 0.037282, 0.0281659, 0.0201422, 0.0133564, 0.00791525, 0.00388401, 0.00128445, 9.46214E-05, 0.000249857, 0.00164507, 0.00413844, 0.0075564, 0.0116996, 0.01635, 0.0212785, 0.0262531, 0.0310476, 0.0354492, 0.0392671, 0.0423388, 0.0445369, 0.0457732, 0.0460023, 0.0452226, 0.0434767, 0.0408484, 0.0374593, 0.0334627, 0.0290367, 0.0243757, 0.0196811, 0.015152, 0.0109752, 0.00731649, 0.00431228, 0.00206303, 0.00062827, 2.37832E-05, 0.000221116, 0.00114946, 0.00269989, 0.00473181, 0.00708124, 0.00957057, 0.0120192, 0.0142544, 0.0161219, 0.0174954, 0.0182842, 0.018439, 0.0179545, 0.0168694, 0.0152636, 0.0132519, 0.010976, 0.00859351, 0.00626668, 0.00415007, 0.00237888, 0.00105869, 0.000257402, 1.35201E-07, 0.000267516, 0.000997664, 0.00209175, 0.00342275, 0.00484676, 0.00621585, 0.00739142, 0.00825684, 0.00872806, 0.00876135, 0.0083571, 0.00755939, 0.00645116, 0.00514543, 0.00377328, 0.00246992, 0.00136013, 0.000544733, 8.96498E-05, 1.87436E-05, 0.00031146, 0.000905615, 0.00170514, 0.00259198, 0.00344079, 0.00413464, 0.0045798, 0.00471762, 0.00453192, 0.00405076, 0.00334217, 0.00250434, 0.00165155, 0.000897577, 0.000339127, 4.16562E-05, 2.97759E-05, 0.000283852, 0.000743475, 0.00131743, 0.00189868, 0.0023821, 0.00268201, 0.0027465, 0.00256609, 0.00217495, 0.0016444, 0.00106956, 0.000551503, 0.000178223, 7.89256E-06, 5.78466E-05, 0.000301541, 0.000674316, 0.00108699, 0.00144468, 0.00166687, 0.00170466, 0.00155112, 0.00124238, 0.000849067, 0.000459624, 0.00015946, 1.06126E-05, 3.69602E-05, 0.000218721, 0.00049785, 0.000793203, 0.00102179, 0.00112065, 0.00106347, 0.000867426, 0.00058789, 0.000302489, 8.86053E-05, 8.4968E-07, 5.51222E-05, 0.000224232, 0.000446676, 0.000646148, 0.000755844, 0.000739856, 0.000604587, 0.000396148, 0.000184324, 3.83054E-05, 2.48519E-06, 8.09477E-05, 0.000236433, 0.000404489, 0.00051786, 0.000532067, 0.000442328, 0.00028498, 0.000122499, 1.78368E-05, 8.4336E-06, 9.08036E-05, 0.000222493, 0.000340939, 0.00039127, 0.000350802, 0.000238979, 0.000107867, 1.72564E-05, 5.9648E-06, 7.32093E-05, 0.000179474, 0.000266833, 0.000288758, 0.000234121, 0.000132624, 3.83588E-05, 1.27561E-08, 3.3966E-05, 0.000115478, 0.000193368, 0.000220116, 0.000179898, 9.76742E-05, 2.34137E-05, 7.65738E-07, 3.9625E-05, 0.000110242, 0.000163123};

  //10nm sphere

  auto pm = NCP::SansIsotropic( Q, I );

  // for ( auto ekin : NC::logspace(-15, 0, 10) ) {
  //   std::cout << "cross section @ " << ekin  << " eV is "
  //             << pm.calcCrossSection(ekin)  <<" barn" << std::endl;
  // }

  // test for speed
  auto rng = NC::getRNG();
  for(unsigned i=0;i<1000000;i++)
  {
    double wl = rng->generate()*5;
    pm.calcCrossSection(NC::wl2ekin(wl));
    pm.sampleScatteringEvent( *rng, NC::wl2ekin(wl) );
  }

  // auto rng = NC::getRNG();
  //
  // for ( auto wl : NC::linspace(1.0, 8.0, 3) ) {
  //   for (unsigned i = 0; i < 10; ++i) {
  //     auto outcome = pm.sampleScatteringEvent( *rng, NC::wl2ekin(wl) );
  //     std::cout << "scattering @ " << wl << " Aa gives neutron with wl = "
  //               << NC::ekin2wl(outcome.ekin_final) <<" Aa and a scattering angle of "
  //               << std::acos(outcome.mu)*NC::kToDeg<<" degrees" << std::endl;
  //
  //   }
  // }



  return 0;
}
